<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Time-Dependent Predictive Accuracy Measures for Joint Models — Accuracy Measures • JMbayes2</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Time-Dependent Predictive Accuracy Measures for Joint Models — Accuracy Measures"><meta name="description" content="Using the available longitudinal information up to a starting time point, these functions compute estimates of the ROC curve and the AUC, the Brier score and expected predictive cross-entropy at a horizon time point based on joint models."><meta property="og:description" content="Using the available longitudinal information up to a starting time point, these functions compute estimates of the ROC curve and the AUC, the Brier score and expected predictive cross-entropy at a horizon time point based on joint models."><meta property="og:image" content="https://drizopoulos.github.io/JMbayes2/reference/figures/square_logo.png"><meta property="og:image:alt" content="JMbayes2: Extended Joint Models for Longitudinal and Time-to-Event Data"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="@drizopoulos"><meta name="twitter:site" content="@drizopoulos"><meta name="robots" content="noindex"><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-YDBZ5DBBSP"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-YDBZ5DBBSP');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">JMbayes2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5-9</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/JMbayes2.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Baseline_Hazard.html">Baseline Hazard Function</a></li>
    <li><a class="dropdown-item" href="../articles/Causal_Effects.html">Causal Effects</a></li>
    <li><a class="dropdown-item" href="../articles/Competing_Risks.html">Competing Risks</a></li>
    <li><a class="dropdown-item" href="../articles/Dynamic_Predictions.html">Dynamic Predictions</a></li>
    <li><a class="dropdown-item" href="../articles/Multi_State_Processes.html">Multi-State Processes</a></li>
    <li><a class="dropdown-item" href="../articles/Non_Gaussian_Mixed_Models.html">Non-Gaussian Mixed Models</a></li>
    <li><a class="dropdown-item" href="../articles/Recurring_Events.html">Recurrent Events</a></li>
    <li><a class="dropdown-item" href="../articles/Super_Learning.html">Combined Dynamic Predictions via Super Learning</a></li>
    <li><a class="dropdown-item" href="../articles/Time_Varying_Effects.html">Time Varying Effects</a></li>
    <li><a class="dropdown-item" href="../articles/Transformation_Functions.html">Transformation Functions for Functional Forms</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/drizopoulos/JMbayes2/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Time-Dependent Predictive Accuracy Measures for Joint Models</h1>

      <div class="d-none name"><code>accuracy.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Using the available longitudinal information up to a starting time point, these functions compute estimates of the ROC curve and the AUC, the Brier score and expected predictive cross-entropy at a horizon time point based on joint models.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">tvROC</span><span class="op">(</span><span class="va">object</span>, <span class="va">newdata</span>, <span class="va">Tstart</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'jm'</span></span>
<span><span class="fu">tvROC</span><span class="op">(</span><span class="va">object</span>, <span class="va">newdata</span>, <span class="va">Tstart</span>, Thoriz <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    Dt <span class="op">=</span> <span class="cn">NULL</span>, type_weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"model-based"</span>, <span class="st">"IPCW"</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">tvAUC</span><span class="op">(</span><span class="va">object</span>, <span class="va">newdata</span>, <span class="va">Tstart</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'jm'</span></span>
<span><span class="fu">tvAUC</span><span class="op">(</span><span class="va">object</span>, <span class="va">newdata</span>, <span class="va">Tstart</span>, Thoriz <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    Dt <span class="op">=</span> <span class="cn">NULL</span>, type_weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"model-based"</span>, <span class="st">"IPCW"</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'tvROC'</span></span>
<span><span class="fu">tvAUC</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">calibration_plot</span><span class="op">(</span><span class="va">object</span>, <span class="va">newdata</span>, <span class="va">Tstart</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'jm'</span></span>
<span><span class="fu">calibration_plot</span><span class="op">(</span><span class="va">object</span>, <span class="va">newdata</span>, <span class="va">Tstart</span>, Thoriz <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    Dt <span class="op">=</span> <span class="cn">NULL</span>, df_ns <span class="op">=</span> <span class="cn">NULL</span>, plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    col <span class="op">=</span> <span class="st">"red"</span>, lty <span class="op">=</span> <span class="fl">1</span>, lwd <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    add_CI <span class="op">=</span> <span class="cn">TRUE</span>, col_CI <span class="op">=</span> <span class="st">"lightgrey"</span>,</span>
<span>    add_density <span class="op">=</span> <span class="cn">TRUE</span>, col_dens <span class="op">=</span> <span class="st">"grey"</span>,</span>
<span>    xlab <span class="op">=</span> <span class="st">"Predicted Probabilities"</span>,</span>
<span>    ylab <span class="op">=</span> <span class="st">"Observed Probabilities"</span>, main <span class="op">=</span> <span class="st">""</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">calibration_metrics</span><span class="op">(</span><span class="va">object</span>, <span class="va">newdata</span>, <span class="va">Tstart</span>, Thoriz <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    Dt <span class="op">=</span> <span class="cn">NULL</span>, df_ns <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">tvBrier</span><span class="op">(</span><span class="va">object</span>, <span class="va">newdata</span>, <span class="va">Tstart</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'jm'</span></span>
<span><span class="fu">tvBrier</span><span class="op">(</span><span class="va">object</span>, <span class="va">newdata</span>, <span class="va">Tstart</span>, Thoriz <span class="op">=</span> <span class="cn">NULL</span>, Dt <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    integrated <span class="op">=</span> <span class="cn">FALSE</span>, type_weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"model-based"</span>, <span class="st">"IPCW"</span><span class="op">)</span>,</span>
<span>    model_weights <span class="op">=</span> <span class="cn">NULL</span>, eventData_fun <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    parallel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"snow"</span>, <span class="st">"multicore"</span><span class="op">)</span>,</span>
<span>    cores <span class="op">=</span> <span class="fu">parallelly</span><span class="fu">::</span><span class="fu"><a href="https://parallelly.futureverse.org/reference/availableCores.html" class="external-link">availableCores</a></span><span class="op">(</span>omit <span class="op">=</span> <span class="fl">1L</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">tvEPCE</span><span class="op">(</span><span class="va">object</span>, <span class="va">newdata</span>, <span class="va">Tstart</span>, Thoriz <span class="op">=</span> <span class="cn">NULL</span>, Dt <span class="op">=</span> <span class="cn">NULL</span>, eps <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>    model_weights <span class="op">=</span> <span class="cn">NULL</span>, eventData_fun <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    parallel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"snow"</span>, <span class="st">"multicore"</span><span class="op">)</span>,</span>
<span>    cores <span class="op">=</span> <span class="fu">parallelly</span><span class="fu">::</span><span class="fu"><a href="https://parallelly.futureverse.org/reference/availableCores.html" class="external-link">availableCores</a></span><span class="op">(</span>omit <span class="op">=</span> <span class="fl">1L</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">create_folds</span><span class="op">(</span><span class="va">data</span>, V <span class="op">=</span> <span class="fl">5</span>, id_var <span class="op">=</span> <span class="st">"id"</span>,</span>
<span>    method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CV"</span>, <span class="st">"Bootstrap"</span><span class="op">)</span>, strata <span class="op">=</span> <span class="cn">NULL</span>, seed <span class="op">=</span> <span class="fl">123L</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>an object inheriting from class <code>jm</code>, except for <code>tvAUC.tvROC()</code> where this is an object of class <code>tvROC</code>. For <code>tvBrier()</code> and <code>tvEPCE()</code> it can also be a library of joint models.</p></dd>


<dt id="arg-newdata">newdata<a class="anchor" aria-label="anchor" href="#arg-newdata"></a></dt>
<dd><p>a data.frame that contains the longitudinal and covariate information for the subjects for which prediction of survival probabilities is required. The names of the variables in this data.frame must be the same as in the data.frames that were used to fit the linear mixed effects and the event process model that were supplied as the two first argument of <code><a href="jm.html">jm</a></code>.</p></dd>


<dt id="arg-tstart">Tstart<a class="anchor" aria-label="anchor" href="#arg-tstart"></a></dt>
<dd><p>numeric scalar denoting the time point up to which longitudinal information is to be used to derive predictions.</p></dd>


<dt id="arg-thoriz">Thoriz<a class="anchor" aria-label="anchor" href="#arg-thoriz"></a></dt>
<dd><p>numeric scalar denoting the time point for which a prediction of the survival status is of interest; <code>Thoriz</code> must be later than <code>Tstart</code> and either <code>Dt</code> or <code>Thoriz</code> must be specified. If <code>Thoriz</code> is <code>NULL</code> is set equal to <code>Tstart + Dt</code>.</p></dd>


<dt id="arg-dt">Dt<a class="anchor" aria-label="anchor" href="#arg-dt"></a></dt>
<dd><p>numeric scalar denoting the length of the time interval of prediction; either <code>Dt</code> or <code>Thoriz</code> must be specified.</p></dd>


<dt id="arg-integrated">integrated<a class="anchor" aria-label="anchor" href="#arg-integrated"></a></dt>
<dd><p>logical; if <code>TRUE</code> the integrated Brier score is calculated.</p></dd>


<dt id="arg-type-weights">type_weights<a class="anchor" aria-label="anchor" href="#arg-type-weights"></a></dt>
<dd><p>character string denoting the type of weights to use to account for censorting. Options are model-based (default) and inverse probability of censoring weighting (using the Kaplan-Meier estimate of the censoring distribution).</p></dd>


<dt id="arg-eps">eps<a class="anchor" aria-label="anchor" href="#arg-eps"></a></dt>
<dd><p>numeric scalar used in the approximation of the hazard function.</p></dd>


<dt id="arg-model-weights">model_weights<a class="anchor" aria-label="anchor" href="#arg-model-weights"></a></dt>
<dd><p>a numeric vector of weights to combine predictions when <code>object</code> is a list of joint models of class <code>"jmList"</code>.</p></dd>


<dt id="arg-eventdata-fun">eventData_fun<a class="anchor" aria-label="anchor" href="#arg-eventdata-fun"></a></dt>
<dd><p>a function that takes as input the <code>newdata</code> and produces the dataset used for the event process model. This is useful when, for example, the event process model contains other time-varying covariates.
It is important that this function does not alter the ordering of the subjects in <code>newdata</code>.</p></dd>


<dt id="arg-parallel">parallel<a class="anchor" aria-label="anchor" href="#arg-parallel"></a></dt>
<dd><p>character string; what type of parallel computing to use.</p></dd>


<dt id="arg-cores">cores<a class="anchor" aria-label="anchor" href="#arg-cores"></a></dt>
<dd><p>integer denoting the number of cores to be used when a library of joint models has been provided in
    <code>object</code>. If <code>cores = 1</code>, no parallel computing is used.</p></dd>


<dt id="arg-df-ns">df_ns<a class="anchor" aria-label="anchor" href="#arg-df-ns"></a></dt>
<dd><p>the degrees of freedom for the natural cubic spline of the cloglog transformation of the predicted
    probabilities used in the Cox model that assesses calibration. The default is 3 unless there are less than 25 events
    in the interval (<code>Tstart</code>, <code>Thoriz</code>] in which case it is 2.</p></dd>


<dt id="arg-plot">plot<a class="anchor" aria-label="anchor" href="#arg-plot"></a></dt>
<dd><p>logical; should a plot be produced. If <code>FALSE</code>, a list is returned with the observed and predicted probabilities.</p></dd>


<dt id="arg-add-ci">add_CI<a class="anchor" aria-label="anchor" href="#arg-add-ci"></a></dt>
<dd><p>logical; should 0.95 pointwise confidence intervals be added around the calibration line.</p></dd>


<dt id="arg-col-ci">col_CI<a class="anchor" aria-label="anchor" href="#arg-col-ci"></a></dt>
<dd><p>character; the color of the shaded area representing the 0.95 pointwise confidence intervals around the calibration line.</p></dd>


<dt id="arg-add-density">add_density<a class="anchor" aria-label="anchor" href="#arg-add-density"></a></dt>
<dd><p>logical; should the kernal density estimation of the predicted probabilities be superimposed in the calibration plot.</p></dd>


<dt id="arg-col-lwd-lty-col-dens-xlab-ylab-main">col, lwd, lty, col_dens, xlab, ylab, main<a class="anchor" aria-label="anchor" href="#arg-col-lwd-lty-col-dens-xlab-ylab-main"></a></dt>
<dd><p>graphical parameters.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>the data.frame to split in folds.</p></dd>


<dt id="arg-v">V<a class="anchor" aria-label="anchor" href="#arg-v"></a></dt>
<dd><p>numeric scalar denoting the number of folds for cross-validation or the number of sample for the Bootstrap methods.</p></dd>


<dt id="arg-id-var">id_var<a class="anchor" aria-label="anchor" href="#arg-id-var"></a></dt>
<dd><p>character string denoting the name of the subject id variable in <code>data</code>.</p></dd>


<dt id="arg-strata">strata<a class="anchor" aria-label="anchor" href="#arg-strata"></a></dt>
<dd><p>character vector with the names of stratifying variables.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>character string indicating which method to use to create the training and testing datasets in
<code>create_folds()</code>. The default is V-fold cross-validation. For the <code>Bootstrap</code> option, <code>V</code> samples
with replacement from the original dataset are proruced as training data. The testing data contains the subjects
that were not selected in the respective Bootstrap sample.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>integer denoting the seed.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional arguments passed to <code><a href="predict.html">predict.jm()</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list of class <code>tvAUC</code> with components:</p>
<dl><dt>auc</dt>
<dd><p>a numeric scalar denoting the estimated prediction error.</p></dd>

  <dt>Tstart</dt>
<dd><p>a copy of the <code>Tstart</code> argument.</p></dd>

  <dt>Thoriz</dt>
<dd><p>a copy of the <code>Thoriz</code> argument.</p></dd>

  <dt>nr</dt>
<dd><p>a numeric scalar denoting the number of subjects at risk at time <code>Tstart</code>.</p></dd>

  <dt>classObject</dt>
<dd><p>the class of <code>object</code>.</p></dd>

  <dt>nameObject</dt>
<dd><p>the name of <code>object</code>.</p></dd>


</dl><p>A list of class <code>tvROC</code> with components:</p>
<dl><dt>TP, FP, nTP, nFN, nTN, qSN, qSP, qOverall</dt>
<dd><p>accuracy indexes.</p></dd>

  <dt>F1score, Youden</dt>
<dd><p>numeric scalars with the optimal cut-point using the F1 score and the Youden index.</p></dd>

  <dt>thr</dt>
<dd><p>numeric vector of thresholds.</p></dd>

  <dt>Tstart</dt>
<dd><p>a copy of the <code>Tstart</code> argument.</p></dd>

  <dt>Thoriz</dt>
<dd><p>a copy of the <code>Thoriz</code> argument.</p></dd>

  <dt>nr</dt>
<dd><p>a numeric scalar denoting the number of subjects at risk at time <code>Tstart</code>.</p></dd>

  <dt>classObject</dt>
<dd><p>the class of <code>object</code>.</p></dd>

  <dt>nameObject</dt>
<dd><p>the name of <code>object</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Antolini, L., Boracchi, P., and Biganzoli, E. (2005). A time-dependent discrimination index
for survival data. <em>Statistics in Medicine</em> <b>24</b>, 3927–3944.</p>
<p>Commenges, D., Liquet, B., and Proust-Lima, C. (2012). Choice of prognostic estimators
in joint models by estimating differences of expected conditional Kullback-Leibler risks.
<em>Biometrics</em> <b>68</b>, 380–387.</p>
<p>Harrell, F., Kerry, L. and Mark, D. (1996). Multivariable prognostic models: issues in
developing models, evaluating assumptions and adequacy, and measuring and reducing errors.
<em>Statistics in Medicine</em> <b>15</b>, 361–387.</p>
<p>Heagerty, P. and Zheng, Y. (2005). Survival model predictive accuracy and ROC curves.
<em>Biometrics</em> <b>61</b>, 92–105.</p>
<p>Rizopoulos, D. (2016). The R package JMbayes for fitting joint models for longitudinal and
time-to-event data using MCMC. <em>Journal of Statistical Software</em> <b>72(7)</b>, 1–45.
doi:10.18637/jss.v072.i07.</p>
<p>Rizopoulos, D. (2012) <em>Joint Models for Longitudinal and Time-to-Event Data: with
Applications in R</em>. Boca Raton: Chapman and Hall/CRC.</p>
<p>Rizopoulos, D. (2011). Dynamic predictions and prospective accuracy in joint models for
longitudinal and time-to-event data. <em>Biometrics</em> <b>67</b>, 819–829.</p>
<p>Rizopoulos, D., Molenberghs, G. and Lesaffre, E.M.E.H. (2017). Dynamic predictions with time-dependent covariates in survival analysis using joint modeling and landmarking. <em>Biometrical Journal</em> <b>59</b>, 1261–1276.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Dimitris Rizopoulos <a href="mailto:d.rizopoulos@erasmusmc.nl">d.rizopoulos@erasmusmc.nl</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></code>, <code><a href="jm.html">jm</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># We fit a multivariate joint model</span></span></span>
<span class="r-in"><span><span class="va">pbc2.id</span><span class="op">$</span><span class="va">status2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">pbc2.id</span><span class="op">$</span><span class="va">status</span> <span class="op">!=</span> <span class="st">'alive'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">CoxFit</span> <span class="op">&lt;-</span> <span class="fu">coxph</span><span class="op">(</span><span class="fu">Surv</span><span class="op">(</span><span class="va">years</span>, <span class="va">status2</span><span class="op">)</span> <span class="op">~</span> <span class="va">sex</span>, data <span class="op">=</span> <span class="va">pbc2.id</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fm1</span> <span class="op">&lt;-</span> <span class="fu">lme</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">serBilir</span><span class="op">)</span> <span class="op">~</span> <span class="fu">ns</span><span class="op">(</span><span class="va">year</span>, <span class="fl">3</span><span class="op">)</span> <span class="op">*</span> <span class="va">sex</span>, data <span class="op">=</span> <span class="va">pbc2</span>,</span></span>
<span class="r-in"><span>           random <span class="op">=</span> <span class="op">~</span> <span class="fu">ns</span><span class="op">(</span><span class="va">year</span>, <span class="fl">3</span><span class="op">)</span> <span class="op">|</span> <span class="va">id</span>, control <span class="op">=</span> <span class="fu">lmeControl</span><span class="op">(</span>opt <span class="op">=</span> <span class="st">'optim'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fm2</span> <span class="op">&lt;-</span> <span class="fu">lme</span><span class="op">(</span><span class="va">prothrombin</span> <span class="op">~</span> <span class="fu">ns</span><span class="op">(</span><span class="va">year</span>, <span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="va">sex</span>, data <span class="op">=</span> <span class="va">pbc2</span>,</span></span>
<span class="r-in"><span>           random <span class="op">=</span> <span class="op">~</span> <span class="fu">ns</span><span class="op">(</span><span class="va">year</span>, <span class="fl">2</span><span class="op">)</span> <span class="op">|</span> <span class="va">id</span>, control <span class="op">=</span> <span class="fu">lmeControl</span><span class="op">(</span>opt <span class="op">=</span> <span class="st">'optim'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fm3</span> <span class="op">&lt;-</span> <span class="fu">mixed_model</span><span class="op">(</span><span class="va">ascites</span> <span class="op">~</span> <span class="va">year</span> <span class="op">*</span> <span class="va">sex</span>, data <span class="op">=</span> <span class="va">pbc2</span>,</span></span>
<span class="r-in"><span>                   random <span class="op">=</span> <span class="op">~</span> <span class="va">year</span> <span class="op">|</span> <span class="va">id</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">jointFit</span> <span class="op">&lt;-</span> <span class="fu"><a href="jm.html">jm</a></span><span class="op">(</span><span class="va">CoxFit</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">fm1</span>, <span class="va">fm2</span>, <span class="va">fm3</span><span class="op">)</span>, time_var <span class="op">=</span> <span class="st">"year"</span>, n_chains <span class="op">=</span> <span class="fl">1L</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">roc</span> <span class="op">&lt;-</span> <span class="fu">tvROC</span><span class="op">(</span><span class="va">jointFit</span>, newdata <span class="op">=</span> <span class="va">pbc2</span>, Tstart <span class="op">=</span> <span class="fl">4</span>, Dt <span class="op">=</span> <span class="fl">3</span>, cores <span class="op">=</span> <span class="fl">1L</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">roc</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Time-dependent Sensitivity and Specificity for the Joint Model jointFit</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> At time: 7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Using information up to time: 4 (225 subjects still at risk)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Accounting for censoring using model-based weights</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    cut-off      SN     SP  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     0.00 0.00000 1.0000  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     0.01 0.01306 0.9978  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     0.03 0.02703 0.9958  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     0.05 0.04880 0.9958  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     0.06 0.06077 0.9933  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     0.07 0.06077 0.9877  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7     0.08 0.08253 0.9877  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8     0.09 0.10430 0.9877  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9     0.10 0.12607 0.9877  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10    0.13 0.14478 0.9813  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11    0.17 0.15942 0.9795  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12    0.18 0.18119 0.9795  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13    0.19 0.18119 0.9739  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14    0.20 0.23145 0.9700  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15    0.21 0.28848 0.9679  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16    0.22 0.30214 0.9658  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17    0.23 0.32391 0.9602  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18    0.25 0.34567 0.9602  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19    0.26 0.36360 0.9481  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20    0.30 0.36360 0.9425  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21    0.32 0.38537 0.9425  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22    0.34 0.40714 0.9425  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23    0.36 0.42891 0.9369  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24    0.37 0.45067 0.9369  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25    0.41 0.49421 0.9369  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26    0.45 0.50564 0.9287  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27    0.46 0.50564 0.9231  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28    0.47 0.51426 0.9141  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29    0.51 0.52846 0.9066  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30    0.54 0.53187 0.8963  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31    0.55 0.55364 0.8851  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32    0.56 0.56056 0.8813  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33    0.57 0.60409 0.8758  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34    0.58 0.64763 0.8758  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35    0.60 0.66939 0.8758  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36    0.61 0.66939 0.8702  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37    0.62 0.66939 0.8590  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38    0.63 0.69619 0.8547  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39    0.65 0.71796 0.8547  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40    0.66 0.71796 0.8491  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41    0.68 0.71908 0.8382  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42    0.69 0.74085 0.8382 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43    0.70 0.74085 0.8327  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44    0.71 0.74530 0.8282  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45    0.72 0.74530 0.8226  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46    0.73 0.74530 0.8059  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47    0.74 0.76707 0.8059  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48    0.75 0.77172 0.7791  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 49    0.77 0.77398 0.7630  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50    0.78 0.77398 0.7574  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 51    0.79 0.77398 0.7462  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 52    0.80 0.79806 0.7412  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 53    0.81 0.82369 0.7255  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 54    0.82 0.83206 0.6997  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 55    0.83 0.85792 0.6784  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 56    0.84 0.85843 0.6618  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 57    0.85 0.86268 0.6349  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 58    0.86 0.86854 0.5918  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 59    0.87 0.87327 0.5762  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 60    0.88 0.87327 0.5483  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 61    0.89 0.87385 0.5373  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 62    0.90 0.88081 0.4609  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 63    0.91 0.90438 0.4390  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 64    0.92 0.92843 0.4228  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 65    0.93 0.92945 0.3784  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 66    0.94 0.93024 0.3339  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 67    0.95 0.99618 0.2783  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 68    0.96 0.99936 0.1897  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 69    0.97 0.99963 0.1172  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 70    0.98 0.99990 0.0279  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 71    0.99 1.00000 0.0000  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu">tvAUC</span><span class="op">(</span><span class="va">roc</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Time-dependent AUC for the Joint Model jointFit</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated AUC:  0.8374</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> At time: 7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Using information up to time: 4 (225 subjects still at risk)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Accounting for censoring using model-based weights</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">roc</span>, legend <span class="op">=</span> <span class="cn">TRUE</span>, optimal_cutoff <span class="op">=</span> <span class="st">"Youden"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="accuracy-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://www.drizopoulos.com/" class="external-link">Dimitris Rizopoulos</a>, <a href="https://pafonso.com/" class="external-link">Pedro Miranda Afonso</a>, <a href="https://gregpapageorgiou.com/" class="external-link">Grigorios Papageorgiou</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

