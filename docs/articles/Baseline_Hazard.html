<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Baseline Hazard Function • JMbayes2</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- katex math --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><script src="../katex-auto.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Baseline Hazard Function">
<meta name="robots" content="noindex">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-YDBZ5DBBSP"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-YDBZ5DBBSP');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">JMbayes2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5-91</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/JMbayes2.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Baseline_Hazard.html">Baseline Hazard Function</a></li>
    <li><a class="dropdown-item" href="../articles/Causal_Effects.html">Causal Effects</a></li>
    <li><a class="dropdown-item" href="../articles/Competing_Risks.html">Competing Risks</a></li>
    <li><a class="dropdown-item" href="../articles/Dynamic_Predictions.html">Dynamic Predictions</a></li>
    <li><a class="dropdown-item" href="../articles/Multi_State_Processes.html">Multi-State Processes</a></li>
    <li><a class="dropdown-item" href="../articles/Non_Gaussian_Mixed_Models.html">Non-Gaussian Mixed Models</a></li>
    <li><a class="dropdown-item" href="../articles/Recurring_Events.html">Recurrent Events</a></li>
    <li><a class="dropdown-item" href="../articles/Super_Learning.html">Combined Dynamic Predictions via Super Learning</a></li>
    <li><a class="dropdown-item" href="../articles/Time_Varying_Effects.html">Time Varying Effects</a></li>
    <li><a class="dropdown-item" href="../articles/Transformation_Functions.html">Transformation Functions for Functional Forms</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/drizopoulos/JMbayes2/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Baseline Hazard Function</h1>
                        <h4 data-toc-skip class="author">Dimitris
Rizopoulos</h4>
            
            <h4 data-toc-skip class="date">2025-08-22</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/drizopoulos/JMbayes2/blob/HEAD/vignettes/Baseline_Hazard.Rmd" class="external-link"><code>vignettes/Baseline_Hazard.Rmd</code></a></small>
      <div class="d-none name"><code>Baseline_Hazard.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="baseline-hazard-function">Baseline Hazard Function<a class="anchor" aria-label="anchor" href="#baseline-hazard-function"></a>
</h2>
<div class="section level3">
<h3 id="penalized-b-splines">Penalized B-splines<a class="anchor" aria-label="anchor" href="#penalized-b-splines"></a>
</h3>
<p>The submodel for the event process in the joint models fitted in
<strong>JMbayes2</strong> is a relative hazard model postulating a
multiplicative effect of the covariates in the hazard scale. The default
specification of the baseline hazard function <span class="math inline">h_0(t)</span> takes the form: <span class="math display">\log \{ h_0(t) \} = \sum \limits_{p = 1}^P \gamma_p
B_p(t, \lambda),</span> where <span class="math inline">B_p(t,
\lambda)</span> denotes the <span class="math inline">p</span>-th basis
function of a B-spline with knots <span class="math inline">\lambda_1,
\ldots, \lambda_P</span> and <span class="math inline">\gamma</span> the
vector of spline coefficients. To ensure smoothness of the baseline
hazard function, we postulate a ‘penalized’ prior distribution for the
spline coefficients <span class="math inline">\gamma</span>:</p>
<p><span class="math display">p(\gamma \mid \tau) \propto
\tau^{\rho(K)/2}\exp \left (-\frac{\tau}{2} \gamma^\top K \gamma \right
),</span></p>
<p>where <span class="math inline">\tau</span> is the smoothing
parameter that takes a <span class="math inline">\mathrm{Gamma}(5,
0.5)</span> hyper-prior to ensure a proper posterior, <span class="math inline">K = \Delta_r^\top \Delta_r</span>, where <span class="math inline">\Delta_r</span> denotes <span class="math inline">r</span>-th difference penalty matrix, and <span class="math inline">\rho(K)</span> denotes the rank of <span class="math inline">K</span>. Different baseline hazard functions can be
specified using the <code>base_hazard</code> and <code>control</code>
arguments of <code><a href="../reference/jm.html">jm()</a></code>. We will illustrate this capability using
the AIDS dataset. We start with the default joint model for the time to
death and the longitudinal measurements of the square root transformed
CD4 cell counts:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Cox regression</span></span>
<span><span class="va">CoxFit</span> <span class="op">&lt;-</span> <span class="fu">coxph</span><span class="op">(</span><span class="fu">Surv</span><span class="op">(</span><span class="va">Time</span>, <span class="va">death</span><span class="op">)</span> <span class="op">~</span> <span class="va">drug</span>, data <span class="op">=</span> <span class="va">aids.id</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># a linear mixed model for sqrt(CD4) cell count</span></span>
<span><span class="va">fm</span> <span class="op">&lt;-</span> <span class="fu">lme</span><span class="op">(</span><span class="va">CD4</span> <span class="op">~</span> <span class="fu">ns</span><span class="op">(</span><span class="va">obstime</span>, <span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="va">drug</span>, data <span class="op">=</span> <span class="va">aids</span>,</span>
<span>           random <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>patient <span class="op">=</span> <span class="fu">pdDiag</span><span class="op">(</span><span class="op">~</span> <span class="fu">ns</span><span class="op">(</span><span class="va">obstime</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># default baseline hazard</span></span>
<span><span class="va">jointFit1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/jm.html">jm</a></span><span class="op">(</span><span class="va">CoxFit</span>, <span class="va">fm</span>, time_var <span class="op">=</span> <span class="st">"obstime"</span><span class="op">)</span></span></code></pre></div>
<p>By default, the knots <span class="math inline">\lambda_1, \ldots,
\lambda_P</span> are placed equidistantly in the interval <span class="math inline">(10^{-8}, T_{max})</span>, where <span class="math inline">T_{max}</span> is the maximum follow-up time. The
number of knots is specified by the control argument
<code>base_hazard_segments</code>, which has a default value of 9. The
degree of the polynomials in the B-spline basis is specified by the
control argument <code>Bsplines_degree</code>; the default is 2, i.e.,
quadratic polynomials. The value of <span class="math inline">r</span>
in the penalty matrix <span class="math inline">\Delta_r</span> is
specified by the control argument <code>diff</code>; by default,
second-order differences are used. The internal function
<code>JMbayes2:::plot_hazard()</code> can be used to depict the
estimated baseline hazard function:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">JMbayes2</span><span class="fu">:::</span><span class="fu">plot_hazard</span><span class="op">(</span><span class="va">jointFit1</span><span class="op">)</span></span></code></pre></div>
<p><img src="Baseline_Hazard_files/figure-html/default%20JM%20-%20estimated%20base%20hazard-1.png" width="816" style="display: block; margin: auto;"></p>
<p>The default specification assumes a B-spline approximation for the
time variable in its original scale. However, as argued in the <a href="https://search.r-project.org/CRAN/refmans/flexsurv/html/flexsurvspline.html" class="external-link"><strong>flexsurv</strong>
package</a>, this specification may have the undesirable property that
the cumulative hazard function does not approach zero at time zero.
Additionally, the default approximation of the baseline hazard is based
on a B-spline basis with quadratic piecewise polynomial functions. We
override both of these settings by specifying a natural cubic spline
(also known as restricted cubic spline) basis for the logarithm of time
using the <code>base_hazard</code> argument:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">jointFit2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">jointFit1</span>, base_hazard <span class="op">=</span> <span class="st">"log time, ns"</span><span class="op">)</span></span>
<span><span class="fu">JMbayes2</span><span class="fu">:::</span><span class="fu">plot_hazard</span><span class="op">(</span><span class="va">jointFit2</span><span class="op">)</span></span></code></pre></div>
<p><img src="Baseline_Hazard_files/figure-html/log%20time-1.png" width="816" style="display: block; margin: auto;"></p>
<p>Setting <code>base_hazard = "log time, ns"</code> corresponds to
setting the control arguments <code>timescale_base_hazard = "log"</code>
and <code>basis = "ns"</code>. Using regular expressions look-up of the
user input in the <code>base_hazard</code> argument, the
<code><a href="../reference/jm.html">jm()</a></code> function attempts to set the corresponding control
arguments. For example, the following call would also set natural cubic
splines with the log time:
<code>update(jointFit1, base_hazard = "ns, log-time")</code>.</p>
</div>
<div class="section level3">
<h3 id="piecewise-constant">Piecewise Constant<a class="anchor" aria-label="anchor" href="#piecewise-constant"></a>
</h3>
<p>To fit a piecewise-constant baseline hazard function by splitting the
follow-up period into five equidistant intervals, we use the call (note
that the piecewise-constant approximation is defined for time in its
original scale again):</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">jointFit3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">jointFit1</span>, base_hazard <span class="op">=</span> <span class="st">"piecewise constant"</span>,</span>
<span>                    base_hazard_segments <span class="op">=</span> <span class="fl">5L</span><span class="op">)</span></span>
<span><span class="fu">JMbayes2</span><span class="fu">:::</span><span class="fu">plot_hazard</span><span class="op">(</span><span class="va">jointFit3</span><span class="op">)</span></span></code></pre></div>
<p><img src="Baseline_Hazard_files/figure-html/piecewise%20constant-1.png" width="816" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="piecewise-linear">Piecewise Linear<a class="anchor" aria-label="anchor" href="#piecewise-linear"></a>
</h3>
<p>A piecewise-linear baseline hazard function for the log time variable
with three interconnected lines is fitted using the syntax:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">jointFit4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">jointFit1</span>, base_hazard <span class="op">=</span> <span class="st">"piecewise linear, log time"</span>,</span>
<span>                    base_hazard_segments <span class="op">=</span> <span class="fl">3L</span>, </span>
<span>                    priors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>penalized_bs_gammas <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">JMbayes2</span><span class="fu">:::</span><span class="fu">plot_hazard</span><span class="op">(</span><span class="va">jointFit4</span><span class="op">)</span></span></code></pre></div>
<p><img src="Baseline_Hazard_files/figure-html/piecewise%20linear-1.png" width="816" style="display: block; margin: auto;"></p>
<p>Via the <code>priors</code> argument, we specified that the <span class="math inline">\gamma</span> coefficients for the piecewise-linear
baseline hazard should not be penalized. In this case, they have a
normal prior with a mean zero and variance 10.</p>
</div>
<div class="section level3">
<h3 id="weibull">Weibull<a class="anchor" aria-label="anchor" href="#weibull"></a>
</h3>
<p>The Weibull baseline hazard function in the log scale corresponds to
a simple linear model with an intercept and a slope term for the
logarithm of the time variable. Hence, it is a special case of the
models we considered above. We can fit a joint model with the Weibull
baseline hazard using the call:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">jointFit5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">jointFit1</span>, base_hazard <span class="op">=</span> <span class="st">"weibull"</span><span class="op">)</span></span>
<span><span class="fu">JMbayes2</span><span class="fu">:::</span><span class="fu">plot_hazard</span><span class="op">(</span><span class="va">jointFit5</span><span class="op">)</span></span></code></pre></div>
<p><img src="Baseline_Hazard_files/figure-html/weibull-1.png" width="816" style="display: block; margin: auto;"></p>
<p>This baseline hazard function also allows extrapolating beyond the
range of observed event times. Actually, extrapolation is possible
whenever a natural cubic spline basis is used. In the following figure,
we extrapolate until month 24:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">JMbayes2</span><span class="fu">:::</span><span class="fu">plot_hazard</span><span class="op">(</span><span class="va">jointFit5</span>, tmax <span class="op">=</span> <span class="fl">24</span><span class="op">)</span></span></code></pre></div>
<p><img src="Baseline_Hazard_files/figure-html/weibull-ext-1.png" width="816" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="stratified-models">Stratified Models<a class="anchor" aria-label="anchor" href="#stratified-models"></a>
</h3>
<p>In case of stratified models, a different baseline hazard is fitted
per stratum. The <code>base_hazard</code> argument can in this case be a
character vector with each element specifying the baseline hazard per
stratum. As an example, we refit the Cox model by stratifying for drug.
Via the <code>base_hazard</code> we specify that for the ddC group the
baseline hazard is Weibull, and for the ddI group a penalized natural
cubic spline for the logarithm of the time variable:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Cox regression</span></span>
<span><span class="va">CoxFit2</span> <span class="op">&lt;-</span> <span class="fu">coxph</span><span class="op">(</span><span class="fu">Surv</span><span class="op">(</span><span class="va">Time</span>, <span class="va">death</span><span class="op">)</span> <span class="op">~</span> <span class="fu">strata</span><span class="op">(</span><span class="va">drug</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">aids.id</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># default baseline hazard</span></span>
<span><span class="va">jointFit6</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/jm.html">jm</a></span><span class="op">(</span><span class="va">CoxFit2</span>, <span class="va">fm</span>, time_var <span class="op">=</span> <span class="st">"obstime"</span>, </span>
<span>                base_hazard <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"weibull"</span>, <span class="st">"log time, ns"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">JMbayes2</span><span class="fu">:::</span><span class="fu">plot_hazard</span><span class="op">(</span><span class="va">jointFit6</span><span class="op">)</span></span></code></pre></div>
<p><img src="Baseline_Hazard_files/figure-html/strata-1.png" width="816" style="display: block; margin: auto;"><img src="Baseline_Hazard_files/figure-html/strata-2.png" width="816" style="display: block; margin: auto;"></p>
<p>Specifying an <code>NA</code> element in <code>base_hazard</code>
will imply that the default baseline hazard function will be used for
this stratum.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://www.drizopoulos.com/" class="external-link">Dimitris Rizopoulos</a>, <a href="https://pafonso.com/" class="external-link">Pedro Miranda Afonso</a>, <a href="https://gregpapageorgiou.com/" class="external-link">Grigorios Papageorgiou</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
