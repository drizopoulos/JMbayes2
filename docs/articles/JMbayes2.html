<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Univariate and Multivariate Joint Models • JMbayes2</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- katex math --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><script src="../katex-auto.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Univariate and Multivariate Joint Models">
<meta name="robots" content="noindex">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-YDBZ5DBBSP"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-YDBZ5DBBSP');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">JMbayes2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5-91</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/JMbayes2.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Baseline_Hazard.html">Baseline Hazard Function</a></li>
    <li><a class="dropdown-item" href="../articles/Causal_Effects.html">Causal Effects</a></li>
    <li><a class="dropdown-item" href="../articles/Competing_Risks.html">Competing Risks</a></li>
    <li><a class="dropdown-item" href="../articles/Dynamic_Predictions.html">Dynamic Predictions</a></li>
    <li><a class="dropdown-item" href="../articles/Multi_State_Processes.html">Multi-State Processes</a></li>
    <li><a class="dropdown-item" href="../articles/Non_Gaussian_Mixed_Models.html">Non-Gaussian Mixed Models</a></li>
    <li><a class="dropdown-item" href="../articles/Recurring_Events.html">Recurrent Events</a></li>
    <li><a class="dropdown-item" href="../articles/Super_Learning.html">Combined Dynamic Predictions via Super Learning</a></li>
    <li><a class="dropdown-item" href="../articles/Time_Varying_Effects.html">Time Varying Effects</a></li>
    <li><a class="dropdown-item" href="../articles/Transformation_Functions.html">Transformation Functions for Functional Forms</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/drizopoulos/JMbayes2/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Univariate and Multivariate Joint Models</h1>
                        <h4 data-toc-skip class="author">Dimitris
Rizopoulos</h4>
            
            <h4 data-toc-skip class="date">2025-08-22</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/drizopoulos/JMbayes2/blob/HEAD/vignettes/JMbayes2.Rmd" class="external-link"><code>vignettes/JMbayes2.Rmd</code></a></small>
      <div class="d-none name"><code>JMbayes2.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="fitting-joint-models-with-jmbayes2">Fitting Joint Models with JMbayes2<a class="anchor" aria-label="anchor" href="#fitting-joint-models-with-jmbayes2"></a>
</h2>
<div class="section level3">
<h3 id="univariate">Univariate<a class="anchor" aria-label="anchor" href="#univariate"></a>
</h3>
<p>The function that fits joint models in <strong>JMbayes2</strong> is
called <code><a href="../reference/jm.html">jm()</a></code>. It has three required arguments,
<code>Surv_object</code> a Cox model fitted by <code><a href="https://rdrr.io/pkg/survival/man/coxph.html" class="external-link">coxph()</a></code> or
an Accelerated Failure time model fitted by <code><a href="https://rdrr.io/pkg/survival/man/survreg.html" class="external-link">survreg()</a></code>,
<code>Mixed_objects</code> a single or a list of mixed models fitted
either by the <code><a href="https://rdrr.io/pkg/nlme/man/lme.html" class="external-link">lme()</a></code> or <code><a href="https://drizopoulos.github.io/GLMMadaptive/reference/mixed_model.html" class="external-link">mixed_model()</a></code>
functions, and <code>time_var</code> a character string indicating the
name of the time variable in the specification of the mixed-effects
models. We will illustrate the basic use of the package in the PBC
dataset. We start by fitting a Cox model for the composite event
transplantation or death, including sex as a baseline covariate:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pbc2.id</span><span class="op">$</span><span class="va">status2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">pbc2.id</span><span class="op">$</span><span class="va">status</span> <span class="op">!=</span> <span class="st">'alive'</span><span class="op">)</span></span>
<span><span class="va">CoxFit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/coxph.html" class="external-link">coxph</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">years</span>, <span class="va">status2</span><span class="op">)</span> <span class="op">~</span> <span class="va">sex</span>, data <span class="op">=</span> <span class="va">pbc2.id</span><span class="op">)</span></span></code></pre></div>
<p>We aim to assess the strength of the association between the risk of
the composite event and the serum bilirubin levels collected during
follow-up. We will describe the patient-specific profiles over time for
this biomarker using a linear mixed model, with fixed effects, time,
sex, and their interaction, and as random effects, random intercepts,
and random slopes. The syntax to fit this model with <code><a href="https://rdrr.io/pkg/nlme/man/lme.html" class="external-link">lme()</a></code>
is:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/lme.html" class="external-link">lme</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">serBilir</span><span class="op">)</span> <span class="op">~</span> <span class="va">year</span> <span class="op">*</span> <span class="va">sex</span>, data <span class="op">=</span> <span class="va">pbc2</span>, random <span class="op">=</span> <span class="op">~</span> <span class="va">year</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span></span></code></pre></div>
<p>The joint model that links the survival and longitudinal submodels is
fitted with the following call to the <code><a href="../reference/jm.html">jm()</a></code> function:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">jointFit1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/jm.html">jm</a></span><span class="op">(</span><span class="va">CoxFit</span>, <span class="va">fm1</span>, time_var <span class="op">=</span> <span class="st">"year"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">jointFit1</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; jm(Surv_object = CoxFit, Mixed_objects = fm1, time_var = "year")</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Data Descriptives:</span></span>
<span><span class="co">#&gt; Number of Groups: 312        Number of events: 169 (54.2%)</span></span>
<span><span class="co">#&gt; Number of Observations:</span></span>
<span><span class="co">#&gt;   log(serBilir): 1945</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                  DIC     WAIC      LPML</span></span>
<span><span class="co">#&gt; marginal    4361.435 5361.220 -3356.241</span></span>
<span><span class="co">#&gt; conditional 3536.629 3355.317 -1907.678</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Random-effects covariance matrix:</span></span>
<span><span class="co">#&gt;                     </span></span>
<span><span class="co">#&gt;        StdDev   Corr</span></span>
<span><span class="co">#&gt; (Intr) 1.0028 (Intr)</span></span>
<span><span class="co">#&gt; year   0.1829 0.3994</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Survival Outcome:</span></span>
<span><span class="co">#&gt;                         Mean  StDev    2.5%  97.5%      P   Rhat</span></span>
<span><span class="co">#&gt; sexfemale            -0.1581 0.2717 -0.6499 0.3848 0.5544 1.0015</span></span>
<span><span class="co">#&gt; value(log(serBilir))  1.2433 0.0847  1.0776 1.4140 0.0000 1.0183</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Longitudinal Outcome: log(serBilir) (family = gaussian, link = identity)</span></span>
<span><span class="co">#&gt;                   Mean  StDev    2.5%   97.5%      P   Rhat</span></span>
<span><span class="co">#&gt; (Intercept)     0.7239 0.1720  0.3821  1.0600 0.0000 0.9997</span></span>
<span><span class="co">#&gt; year            0.2668 0.0381  0.1929  0.3444 0.0000 1.0024</span></span>
<span><span class="co">#&gt; sexfemale      -0.2639 0.1823 -0.6192  0.0882 0.1511 0.9999</span></span>
<span><span class="co">#&gt; year:sexfemale -0.0886 0.0404 -0.1681 -0.0093 0.0247 1.0028</span></span>
<span><span class="co">#&gt; sigma           0.3465 0.0065  0.3342  0.3596 0.0000 1.0101</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; MCMC summary:</span></span>
<span><span class="co">#&gt; chains: 3 </span></span>
<span><span class="co">#&gt; iterations per chain: 3500 </span></span>
<span><span class="co">#&gt; burn-in per chain: 500 </span></span>
<span><span class="co">#&gt; thinning: 1 </span></span>
<span><span class="co">#&gt; time: 16 sec</span></span></code></pre></div>
<p>The output of the <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> method provides some
descriptive statistics of the sample at hand, followed by some fit
statistics based on the marginal (random effects are integrated out
using the Laplace approximation) and conditional on the random effects
log-likelihood functions, followed by the estimated variance-covariance
matrix for the random effects, followed by the estimates for the
survival submodel, followed by the estimates for the longitudinal
submodel(s), and finally some information for the MCMC fitting
algorithm.</p>
<p>By default, <code><a href="../reference/jm.html">jm()</a></code> adds the subject-specific linear
predictor of the mixed model as a time-varying covariate in the survival
relative risk model. In the output, this is named as
<code>value(log(serBilir))</code> to denote that, by default, the
current value functional form is used. That is, we assume that the
instantaneous risk of an event at a specific time <span class="math inline">t</span> is associated with the value of the linear
predictor of the longitudinal outcome at the same time point <span class="math inline">t</span>.</p>
<p>Standard MCMC diagnostics are available to evaluate convergence. For
example, the traceplot for the association coefficient
<code>value(log(serBilir))</code> is produced with the following
syntax:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/coda_methods.html">ggtraceplot</a></span><span class="op">(</span><span class="va">jointFit1</span>, <span class="st">"alphas"</span><span class="op">)</span></span></code></pre></div>
<p><img src="JMbayes2_files/figure-html/unnamed-chunk-4-1.png" width="700" style="display: block; margin: auto;"></p>
<p>and the density plot with the call:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/coda_methods.html">ggdensityplot</a></span><span class="op">(</span><span class="va">jointFit1</span>, <span class="st">"alphas"</span><span class="op">)</span></span></code></pre></div>
<p><img src="JMbayes2_files/figure-html/unnamed-chunk-5-1.png" width="700" style="display: block; margin: auto;"></p>
<div class="section level4">
<h4 id="notes">Notes<a class="anchor" aria-label="anchor" href="#notes"></a>
</h4>
<ul>
<li><p>The ordering of the subjects in the datasets used to fit the
mixed and Cox regression models needs to be the same.</p></li>
<li><p>The units of the time variables in the mixed and Cox models need
to be the same.</p></li>
</ul>
</div>
</div>
<div class="section level3">
<h3 id="multivariate">Multivariate<a class="anchor" aria-label="anchor" href="#multivariate"></a>
</h3>
<p>To fit a joint model with multiple longitudinal outcomes, we provide
a list of mixed models as the second argument of <code><a href="../reference/jm.html">jm()</a></code>. In
the following example, we extend the joint model we fitted above by
including the prothrombin time and the log odds of the presence or
absence of ascites as time-varying covariates in the relative risk model
for the composite event. Ascites is a dichotomous outcome, and
therefore, we fit a mixed-effects logistic regression model for it using
the <code><a href="https://drizopoulos.github.io/GLMMadaptive/reference/mixed_model.html" class="external-link">mixed_model()</a></code> function from the
<strong>GLMMadaptive</strong> package. The use of <code>||</code> in the
<code>random</code> argument of <code><a href="https://drizopoulos.github.io/GLMMadaptive/reference/mixed_model.html" class="external-link">mixed_model()</a></code> specifies
that the random intercepts and random slopes are assumed uncorrelated.
In addition, the argument <code>which_independent</code> can be used to
determine which longitudinal outcomes are to be assumed independent;
here, as an illustration, we specify that the first (i.e., serum
bilirubin) and second (i.e., prothrombin time) longitudinal outcomes are
independent. To assume that all longitudinal outcomes are independent,
we can use <code>jm(..., which_independent = "all")</code>. Because this
joint model is more complex, we increase the number of MCMC iterations,
the number of burn-in iterations, and the thinning per chain using the
corresponding control arguments:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fm2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/lme.html" class="external-link">lme</a></span><span class="op">(</span><span class="va">prothrombin</span> <span class="op">~</span> <span class="va">year</span> <span class="op">*</span> <span class="va">sex</span>, data <span class="op">=</span> <span class="va">pbc2</span>, random <span class="op">=</span> <span class="op">~</span> <span class="va">year</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span></span>
<span><span class="va">fm3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://drizopoulos.github.io/GLMMadaptive/reference/mixed_model.html" class="external-link">mixed_model</a></span><span class="op">(</span><span class="va">ascites</span> <span class="op">~</span> <span class="va">year</span> <span class="op">+</span> <span class="va">sex</span>, data <span class="op">=</span> <span class="va">pbc2</span>,</span>
<span>                   random <span class="op">=</span> <span class="op">~</span> <span class="va">year</span> <span class="op">||</span> <span class="va">id</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">jointFit2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/jm.html">jm</a></span><span class="op">(</span><span class="va">CoxFit</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">fm1</span>, <span class="va">fm2</span>, <span class="va">fm3</span><span class="op">)</span>, time_var <span class="op">=</span> <span class="st">"year"</span>,</span>
<span>                which_independent <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>                n_iter <span class="op">=</span> <span class="fl">12000L</span>, n_burnin <span class="op">=</span> <span class="fl">2000L</span>, n_thin <span class="op">=</span> <span class="fl">5L</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">jointFit2</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; jm(Surv_object = CoxFit, Mixed_objects = list(fm1, fm2, fm3), </span></span>
<span><span class="co">#&gt;     time_var = "year", which_independent = cbind(1, 2), n_iter = 12000L, </span></span>
<span><span class="co">#&gt;     n_burnin = 2000L, n_thin = 5L)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Data Descriptives:</span></span>
<span><span class="co">#&gt; Number of Groups: 312        Number of events: 169 (54.2%)</span></span>
<span><span class="co">#&gt; Number of Observations:</span></span>
<span><span class="co">#&gt;   log(serBilir): 1945</span></span>
<span><span class="co">#&gt;   prothrombin: 1945</span></span>
<span><span class="co">#&gt;   ascites: 1885</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                  DIC     WAIC      LPML</span></span>
<span><span class="co">#&gt; marginal    11655.22 16089.26 -8730.453</span></span>
<span><span class="co">#&gt; conditional 12879.91 12590.61 -6812.813</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Random-effects covariance matrix:</span></span>
<span><span class="co">#&gt;                                                   </span></span>
<span><span class="co">#&gt;        StdDev   Corr                              </span></span>
<span><span class="co">#&gt; (Intr) 1.0022 (Intr)   year (Intr)    year  (Intr)</span></span>
<span><span class="co">#&gt; year   0.1866 0.4490                              </span></span>
<span><span class="co">#&gt; (Intr) 0.7625                                     </span></span>
<span><span class="co">#&gt; year   0.3241               -0.0122               </span></span>
<span><span class="co">#&gt; (Intr) 2.7049 0.5177 0.4745 0.3283  -0.0298       </span></span>
<span><span class="co">#&gt; year   0.4613 0.4057 0.6660 -0.0592 0.3448        </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Survival Outcome:</span></span>
<span><span class="co">#&gt;                         Mean  StDev    2.5%  97.5%      P   Rhat</span></span>
<span><span class="co">#&gt; sexfemale            -0.6621 0.3613 -1.3655 0.0338 0.0607 1.0140</span></span>
<span><span class="co">#&gt; value(log(serBilir))  0.4863 0.1786  0.1096 0.8212 0.0147 1.0545</span></span>
<span><span class="co">#&gt; value(prothrombin)   -0.0583 0.1244 -0.3296 0.1735 0.6293 1.0612</span></span>
<span><span class="co">#&gt; value(ascites)        0.6227 0.1460  0.3708 0.9518 0.0000 1.0703</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Longitudinal Outcome: log(serBilir) (family = gaussian, link = identity)</span></span>
<span><span class="co">#&gt;                   Mean  StDev    2.5%   97.5%     P   Rhat</span></span>
<span><span class="co">#&gt; (Intercept)     0.6926 0.1691  0.3584  1.0311 0.000 1.0003</span></span>
<span><span class="co">#&gt; year            0.2694 0.0349  0.2005  0.3383 0.000 1.0004</span></span>
<span><span class="co">#&gt; sexfemale      -0.2357 0.1795 -0.5953  0.1183 0.190 1.0002</span></span>
<span><span class="co">#&gt; year:sexfemale -0.0800 0.0362 -0.1508 -0.0097 0.024 1.0022</span></span>
<span><span class="co">#&gt; sigma           0.3480 0.0068  0.3347  0.3617 0.000 1.0047</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Longitudinal Outcome: prothrombin (family = gaussian, link = identity)</span></span>
<span><span class="co">#&gt;                   Mean  StDev    2.5%   97.5%      P   Rhat</span></span>
<span><span class="co">#&gt; (Intercept)    10.9863 0.1728 10.6532 11.3254 0.0000 1.0033</span></span>
<span><span class="co">#&gt; year            0.2081 0.0774  0.0592  0.3599 0.0070 1.0065</span></span>
<span><span class="co">#&gt; sexfemale      -0.4422 0.1831 -0.8040 -0.0912 0.0100 1.0051</span></span>
<span><span class="co">#&gt; year:sexfemale  0.0470 0.0809 -0.1130  0.2029 0.5577 1.0088</span></span>
<span><span class="co">#&gt; sigma           1.0569 0.0202  1.0185  1.0975 0.0000 1.0004</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Longitudinal Outcome: ascites (family = binomial, link = logit)</span></span>
<span><span class="co">#&gt;                Mean  StDev    2.5%   97.5%      P   Rhat</span></span>
<span><span class="co">#&gt; (Intercept) -4.4912 0.6735 -5.9197 -3.2356 0.0000 1.0121</span></span>
<span><span class="co">#&gt; year         0.6393 0.0684  0.5128  0.7854 0.0000 1.0651</span></span>
<span><span class="co">#&gt; sexfemale   -0.5556 0.6565 -1.8222  0.7787 0.3913 1.0021</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; MCMC summary:</span></span>
<span><span class="co">#&gt; chains: 3 </span></span>
<span><span class="co">#&gt; iterations per chain: 12000 </span></span>
<span><span class="co">#&gt; burn-in per chain: 2000 </span></span>
<span><span class="co">#&gt; thinning: 5 </span></span>
<span><span class="co">#&gt; time: 1.9 min</span></span></code></pre></div>
<p>The survival submodel output now contains the estimated coefficients
for <code>value(prothrombin)</code> and <code>value(ascites)</code>, as
well as parameter estimates for all three longitudinal submodels.</p>
</div>
<div class="section level3">
<h3 id="functional-forms">Functional forms<a class="anchor" aria-label="anchor" href="#functional-forms"></a>
</h3>
<p>As mentioned above, the default call to <code><a href="../reference/jm.html">jm()</a></code> includes
the subject-specific linear predictors of the mixed-effects models as
time-varying covariates in the relative risk model. However, this is
just one of the many possibilities for linking longitudinal and survival
outcomes. The argument <code>functional_forms</code> of
<code><a href="../reference/jm.html">jm()</a></code> provides additional options. Based on previous
experience, two extra functional forms are provided: the time-varying
slope and the time-varying <em>normalized</em> area/cumulative effect.
The time-varying slope is the first-order derivative of the
subject-specific linear predictor of the mixed-effect model with respect
to the (follow-up) time variable. The time-varying <em>normalized</em>
area/cumulative effect is the integral of the subject-specific linear
predictor of the mixed-effect model from zero to the current (follow-up)
time <span class="math inline">t</span> divided by <span class="math inline">t</span>. The integral is the area under the
subject-specific longitudinal profile; by dividing the integral by <span class="math inline">t</span>, we obtain the average of the
subject-specific longitudinal profile over the corresponding period
<span class="math inline">(0, t)</span>.</p>
<p>To illustrate how the <code>functional_forms</code> argument can be
used to specify these functional forms, we update the joint model
<code>jointFit2</code> by including the time-varying slope of log serum
bilirubin instead of the value and also the interaction of this slope
with sex and for prothrombin we include the normalized cumulative
effect. For ascites, we keep the current value functional form. The
corresponding syntax to fit this model is:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fForms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"log(serBilir)"</span> <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="../reference/jm.html">slope</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">serBilir</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/jm.html">slope</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">serBilir</span><span class="op">)</span><span class="op">)</span><span class="op">:</span><span class="va">sex</span>,</span>
<span>  <span class="st">"prothrombin"</span> <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="../reference/jm.html">area</a></span><span class="op">(</span><span class="va">prothrombin</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">jointFit3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">jointFit2</span>, functional_forms <span class="op">=</span> <span class="va">fForms</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">jointFit3</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; jm(Surv_object = CoxFit, Mixed_objects = list(fm1, fm2, fm3), </span></span>
<span><span class="co">#&gt;     time_var = "year", functional_forms = fForms, which_independent = cbind(1, </span></span>
<span><span class="co">#&gt;         2), n_iter = 12000L, n_burnin = 2000L, n_thin = 5L)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Data Descriptives:</span></span>
<span><span class="co">#&gt; Number of Groups: 312        Number of events: 169 (54.2%)</span></span>
<span><span class="co">#&gt; Number of Observations:</span></span>
<span><span class="co">#&gt;   log(serBilir): 1945</span></span>
<span><span class="co">#&gt;   prothrombin: 1945</span></span>
<span><span class="co">#&gt;   ascites: 1885</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                  DIC     WAIC      LPML</span></span>
<span><span class="co">#&gt; marginal    11692.23 12995.55 -7306.362</span></span>
<span><span class="co">#&gt; conditional 12656.91 12381.64 -6669.114</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Random-effects covariance matrix:</span></span>
<span><span class="co">#&gt;                                                   </span></span>
<span><span class="co">#&gt;        StdDev   Corr                              </span></span>
<span><span class="co">#&gt; (Intr) 0.9989 (Intr)   year (Intr)    year  (Intr)</span></span>
<span><span class="co">#&gt; year   0.1853 0.4548                              </span></span>
<span><span class="co">#&gt; (Intr) 0.7500                                     </span></span>
<span><span class="co">#&gt; year   0.3232               -0.0047               </span></span>
<span><span class="co">#&gt; (Intr) 2.5559 0.5529 0.4692 0.3487  -0.0775       </span></span>
<span><span class="co">#&gt; year   0.4361 0.4303 0.6690 -0.0720 0.3773        </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Survival Outcome:</span></span>
<span><span class="co">#&gt;                                   Mean  StDev     2.5%  97.5%      P   Rhat</span></span>
<span><span class="co">#&gt; sexfemale                       0.3595 0.9644  -1.3670 2.3829 0.7557 1.0662</span></span>
<span><span class="co">#&gt; slope(log(serBilir))            4.3938 2.5197  -0.0624 9.5851 0.0577 1.1294</span></span>
<span><span class="co">#&gt; slope(log(serBilir)):sexfemale -4.3880 3.0045 -11.1525 0.5844 0.1020 1.1396</span></span>
<span><span class="co">#&gt; area(prothrombin)              -0.4097 0.3097  -0.9998 0.1627 0.1957 1.3476</span></span>
<span><span class="co">#&gt; value(ascites)                  1.0639 0.2373   0.6257 1.5698 0.0000 1.3015</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Longitudinal Outcome: log(serBilir) (family = gaussian, link = identity)</span></span>
<span><span class="co">#&gt;                   Mean  StDev    2.5%   97.5%      P   Rhat</span></span>
<span><span class="co">#&gt; (Intercept)     0.6684 0.1660  0.3397  0.9945 0.0003 1.0079</span></span>
<span><span class="co">#&gt; year            0.2658 0.0336  0.2025  0.3346 0.0000 1.0005</span></span>
<span><span class="co">#&gt; sexfemale      -0.2049 0.1768 -0.5497  0.1392 0.2433 1.0087</span></span>
<span><span class="co">#&gt; year:sexfemale -0.0745 0.0348 -0.1450 -0.0079 0.0270 1.0008</span></span>
<span><span class="co">#&gt; sigma           0.3483 0.0066  0.3352  0.3615 0.0000 1.0046</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Longitudinal Outcome: prothrombin (family = gaussian, link = identity)</span></span>
<span><span class="co">#&gt;                   Mean  StDev    2.5%   97.5%      P   Rhat</span></span>
<span><span class="co">#&gt; (Intercept)    10.9993 0.1684 10.6565 11.3294 0.0000 1.0003</span></span>
<span><span class="co">#&gt; year            0.1839 0.0764  0.0325  0.3362 0.0140 1.0056</span></span>
<span><span class="co">#&gt; sexfemale      -0.4574 0.1786 -0.7983 -0.1039 0.0140 1.0006</span></span>
<span><span class="co">#&gt; year:sexfemale  0.0702 0.0806 -0.0884  0.2279 0.3857 1.0058</span></span>
<span><span class="co">#&gt; sigma           1.0591 0.0203  1.0197  1.0994 0.0000 1.0152</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Longitudinal Outcome: ascites (family = binomial, link = logit)</span></span>
<span><span class="co">#&gt;                Mean  StDev    2.5%   97.5%      P   Rhat</span></span>
<span><span class="co">#&gt; (Intercept) -4.4105 0.6235 -5.7030 -3.2274 0.0000 1.0378</span></span>
<span><span class="co">#&gt; year         0.6304 0.0777  0.4830  0.7938 0.0000 1.2194</span></span>
<span><span class="co">#&gt; sexfemale   -0.4225 0.6122 -1.6453  0.7616 0.4833 1.0057</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; MCMC summary:</span></span>
<span><span class="co">#&gt; chains: 3 </span></span>
<span><span class="co">#&gt; iterations per chain: 12000 </span></span>
<span><span class="co">#&gt; burn-in per chain: 2000 </span></span>
<span><span class="co">#&gt; thinning: 5 </span></span>
<span><span class="co">#&gt; time: 2 min</span></span></code></pre></div>
<p>As seen above, the <code>functional_forms</code> argument is a named
list with elements corresponding to the longitudinal outcomes. If a
longitudinal outcome is not specified in this list, then the default
value functional form is used for that outcome. Each element of the list
should be a one-sided R formula in which the functions
<code><a href="../reference/jm.html">value()</a></code>, <code><a href="../reference/jm.html">slope()</a></code>, and <code><a href="../reference/jm.html">area()</a></code> can
be used. Interaction terms between the functional forms and other
(baseline) covariates are also allowed.</p>
</div>
<div class="section level3">
<h3 id="penalized-coefficients-using-shrinkage-priors">Penalized Coefficients using Shrinkage Priors<a class="anchor" aria-label="anchor" href="#penalized-coefficients-using-shrinkage-priors"></a>
</h3>
<p>When multiple longitudinal outcomes are considered with possibly
different functional forms per outcome, we require to fit a relative
risk model containing several terms. Moreover, it is often of scientific
interest to select which terms/functional forms per longitudinal outcome
are more strongly associated with the risk of the event of interest. To
facilitate this selection, <code><a href="../reference/jm.html">jm()</a></code> allows penalizing the
regression coefficients using shrinkage priors. As an example, we refit
<code>jointFit3</code> by assuming a Horseshoe prior for the
<code>alphas</code> coefficients (i.e., the coefficients of the
longitudinal outcomes in the relative risk model):</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">jointFit4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">jointFit3</span>, priors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"penalty_alphas"</span> <span class="op">=</span> <span class="st">"horseshoe"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="st">"un-penalized"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="../reference/methods.html">coef</a></span><span class="op">(</span><span class="va">jointFit3</span><span class="op">)</span><span class="op">)</span>, </span>
<span>      <span class="st">"penalized"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="../reference/methods.html">coef</a></span><span class="op">(</span><span class="va">jointFit4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;                                            un-penalized  penalized</span></span>
<span><span class="co">#&gt; gammas.Mean                                   0.3594950 -0.5053443</span></span>
<span><span class="co">#&gt; association.slope(log(serBilir))              4.3938467  2.0175752</span></span>
<span><span class="co">#&gt; association.slope(log(serBilir)):sexfemale   -4.3879624 -0.8996426</span></span>
<span><span class="co">#&gt; association.area(prothrombin)                -0.4096893 -0.1321933</span></span>
<span><span class="co">#&gt; association.value(ascites)                    1.0639313  0.8572684</span></span></code></pre></div>
<p>Apart from the Horseshoe prior, the ridge prior is also provided.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://www.drizopoulos.com/" class="external-link">Dimitris Rizopoulos</a>, <a href="https://pafonso.com/" class="external-link">Pedro Miranda Afonso</a>, <a href="https://gregpapageorgiou.com/" class="external-link">Grigorios Papageorgiou</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
