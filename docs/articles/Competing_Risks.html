<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Competing Risks â€¢ JMbayes2</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Competing Risks">
<meta property="og:description" content="JMbayes2">
<meta property="og:image" content="https://drizopoulos.github.io/JMbayes2/reference/figures/square_logo.png">
<meta property="og:image:alt" content="JMbayes2: Extended Joint Models for Longitudinal and Time-to-Event Data">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:creator" content="@drizopoulos">
<meta name="twitter:site" content="@drizopoulos">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-YDBZ5DBBSP"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-YDBZ5DBBSP');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">JMbayes2</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3-0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/JMbayes2.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Competing_Risks.html">Competing Risks</a>
    </li>
    <li>
      <a href="../articles/Dynamic_Predictions.html">Dynamic Predictions</a>
    </li>
    <li>
      <a href="../articles/Multi_State_Processes.html">Multi-State Processes</a>
    </li>
    <li>
      <a href="../articles/Non_Gaussian_Mixed_Models.html">Non-Gaussian Mixed Models</a>
    </li>
    <li>
      <a href="../articles/Recurring_Events.html">Recurrent Events</a>
    </li>
    <li>
      <a href="../articles/Transformation_Functions.html">Transformation Functions for Functional Forms</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/drizopoulos/JMbayes2/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Competing Risks</h1>
                        <h4 data-toc-skip class="author">Dimitris
Rizopoulos</h4>
            
            <h4 data-toc-skip class="date">2022-09-09</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/drizopoulos/JMbayes2/blob/HEAD/vignettes/Competing_Risks.Rmd" class="external-link"><code>vignettes/Competing_Risks.Rmd</code></a></small>
      <div class="hidden name"><code>Competing_Risks.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="competing-risks">Competing Risks<a class="anchor" aria-label="anchor" href="#competing-risks"></a>
</h2>
<div class="section level3">
<h3 id="prepare-data">Prepare data<a class="anchor" aria-label="anchor" href="#prepare-data"></a>
</h3>
<p>The first step to fit a joint model for competing events in
<strong>JMbayes2</strong> is to prepare the data for the event process.
If there are <span class="math inline">\(K\)</span> competing events,
then each subject needs to have <span class="math inline">\(K\)</span>
rows, one for each possible cause. The observed event time <span class="math inline">\(T_i\)</span> of each subject is repeated <span class="math inline">\(K\)</span> times, and there are two indicator
variables, namely one identifying the cause, and one indicating whether
the corresponding event type is the one that occurred. Standard survival
datasets that included a single row per patient, can be easily
transformed to the competing risks long format using function
<code><a href="../reference/cr_setup.html">crisk_setup()</a></code>. This function accepts as main arguments the
survival data in the standard format that has a single row per patient,
the name of the status variable, and the level in this status variable
that corresponds to censoring. We illustrate the use of this function in
the PBC data, in which we treat as competing risks transplantation and
death:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pbc2.id</span><span class="op">[</span><span class="va">pbc2.id</span><span class="op">$</span><span class="va">id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"id"</span>, <span class="st">"years"</span>, <span class="st">"status"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt;   id     years       status</span></span>
<span><span class="co">#&gt; 1  1  1.095170         dead</span></span>
<span><span class="co">#&gt; 2  2 14.152338        alive</span></span>
<span><span class="co">#&gt; 5  5  4.120578 transplanted</span></span>
<span></span>
<span><span class="va">pbc2.idCR</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cr_setup.html">crisk_setup</a></span><span class="op">(</span><span class="va">pbc2.id</span>, statusVar <span class="op">=</span> <span class="st">"status"</span>, censLevel <span class="op">=</span> <span class="st">"alive"</span>, </span>
<span>                         nameStrata <span class="op">=</span> <span class="st">"CR"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pbc2.idCR</span><span class="op">[</span><span class="va">pbc2.idCR</span><span class="op">$</span><span class="va">id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">5</span><span class="op">)</span>, </span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"id"</span>, <span class="st">"years"</span>, <span class="st">"status"</span>, <span class="st">"status2"</span>, <span class="st">"CR"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt;     id     years       status status2           CR</span></span>
<span><span class="co">#&gt; 1    1  1.095170         dead       1         dead</span></span>
<span><span class="co">#&gt; 1.1  1  1.095170         dead       0 transplanted</span></span>
<span><span class="co">#&gt; 2    2 14.152338        alive       0         dead</span></span>
<span><span class="co">#&gt; 2.1  2 14.152338        alive       0 transplanted</span></span>
<span><span class="co">#&gt; 5    5  4.120578 transplanted       0         dead</span></span>
<span><span class="co">#&gt; 5.1  5  4.120578 transplanted       1 transplanted</span></span></code></pre></div>
<p>Note that each patient is now represented by two rows (we have two
possible causes of discontinuation from the study, death and
transplantation), the event time variable <code>years</code> is
identical in both rows of each patient, variable <code>CR</code> denotes
the cause for the specific line of the long dataset, and variable
<code>status2</code> equals 1 if the corresponding event occurred.</p>
</div>
<div class="section level3">
<h3 id="fit-models">Fit models<a class="anchor" aria-label="anchor" href="#fit-models"></a>
</h3>
<p>For the event process, we specify cause-specific relative risks
models. Using dataset <code>pbc2.idCR</code>, we fit the corresponding
cause-specific Cox regressions by including the interaction terms of age
and treatment with variable <code>CR</code>, which is treated as a
stratification variable using the <code>strata()</code> function:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CoxFit_CR</span> <span class="op">&lt;-</span> <span class="fu">coxph</span><span class="op">(</span><span class="fu">Surv</span><span class="op">(</span><span class="va">years</span>, <span class="va">status2</span><span class="op">)</span> <span class="op">~</span> <span class="op">(</span><span class="va">age</span> <span class="op">+</span> <span class="va">drug</span><span class="op">)</span> <span class="op">*</span> <span class="fu">strata</span><span class="op">(</span><span class="va">CR</span><span class="op">)</span>,</span>
<span>                     data <span class="op">=</span> <span class="va">pbc2.idCR</span><span class="op">)</span></span></code></pre></div>
<p>For the longitudinal process, we include two longitudinal outcomes,
namely serum bilirubin and the prothrombin time. For the former we use
quadratic orthogonal polynomials in the fixed- and random-effects parts,
and for the latter linear evolutions:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fm1</span> <span class="op">&lt;-</span> <span class="fu">lme</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">serBilir</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/poly.html" class="external-link">poly</a></span><span class="op">(</span><span class="va">year</span>, <span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="va">drug</span>, data <span class="op">=</span> <span class="va">pbc2</span>, </span>
<span>           random <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/poly.html" class="external-link">poly</a></span><span class="op">(</span><span class="va">year</span>, <span class="fl">2</span><span class="op">)</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span></span>
<span><span class="va">fm2</span> <span class="op">&lt;-</span> <span class="fu">lme</span><span class="op">(</span><span class="va">prothrombin</span> <span class="op">~</span> <span class="va">year</span> <span class="op">*</span> <span class="va">drug</span>, data <span class="op">=</span> <span class="va">pbc2</span>, random <span class="op">=</span> <span class="op">~</span> <span class="va">year</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span></span></code></pre></div>
<p>To specify that each longitudinal outcome has a separate association
coefficient per competing risk, we define the corresponding functional
forms:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CR_forms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"log(serBilir)"</span> <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="../reference/jm.html">value</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">serBilir</span><span class="op">)</span><span class="op">)</span><span class="op">:</span><span class="va">CR</span>,</span>
<span>    <span class="st">"prothrombin"</span> <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="../reference/jm.html">value</a></span><span class="op">(</span><span class="va">prothrombin</span><span class="op">)</span><span class="op">:</span><span class="va">CR</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Finally, the competing risks joint model is fitted with the following
call to <code><a href="../reference/jm.html">jm()</a></code> (due to the complexity of the model, we have
increased the number of MCMC iterations and the burn-in period per
chain):</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">jFit_CR</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/jm.html">jm</a></span><span class="op">(</span><span class="va">CoxFit_CR</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">fm1</span>, <span class="va">fm2</span><span class="op">)</span>, time_var <span class="op">=</span> <span class="st">"year"</span>, </span>
<span>              functional_forms <span class="op">=</span> <span class="va">CR_forms</span>, </span>
<span>              n_iter <span class="op">=</span> <span class="fl">25000L</span>, n_burnin <span class="op">=</span> <span class="fl">5000L</span>, n_thin <span class="op">=</span> <span class="fl">5L</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">jFit_CR</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; jm(Surv_object = CoxFit_CR, Mixed_objects = list(fm1, fm2), time_var = "year", </span></span>
<span><span class="co">#&gt;     functional_forms = CR_forms, n_iter = 25000L, n_burnin = 5000L, </span></span>
<span><span class="co">#&gt;     n_thin = 5L)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Data Descriptives:</span></span>
<span><span class="co">#&gt; Number of Groups: 312        Number of events: 169 (27.1%)</span></span>
<span><span class="co">#&gt; Number of Observations:</span></span>
<span><span class="co">#&gt;   log(serBilir): 1945</span></span>
<span><span class="co">#&gt;   prothrombin: 1945</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                  DIC     WAIC      LPML</span></span>
<span><span class="co">#&gt; marginal    10638.85 10843.25 -5736.199</span></span>
<span><span class="co">#&gt; conditional 15754.08 15437.73 -8218.645</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Random-effects covariance matrix:</span></span>
<span><span class="co">#&gt;                                              </span></span>
<span><span class="co">#&gt;        StdDev    Corr                        </span></span>
<span><span class="co">#&gt; (Intr) 1.3331  (Intr)  p(,2)1  p(,2)2  (Intr)</span></span>
<span><span class="co">#&gt; p(,2)1 22.5073 0.6871                        </span></span>
<span><span class="co">#&gt; p(,2)2 12.4989 -0.2906 -0.1586               </span></span>
<span><span class="co">#&gt; (Intr) 0.7867  0.6315  0.4254  -0.3413       </span></span>
<span><span class="co">#&gt; year   0.3284  0.4328  0.3264  -0.0771 0.0307</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Survival Outcome:</span></span>
<span><span class="co">#&gt;                                        Mean  StDev    2.5%   97.5%      P</span></span>
<span><span class="co">#&gt; age                                 -0.0480 0.0215 -0.0909 -0.0077 0.0177</span></span>
<span><span class="co">#&gt; drugD-penicil                       -0.3071 0.3958 -1.0971  0.4627 0.4378</span></span>
<span><span class="co">#&gt; age:strata(CR)dead                   0.1066 0.0205  0.0674  0.1455 0.0000</span></span>
<span><span class="co">#&gt; drugD-penicil:strata(CR)dead         0.2979 0.4289 -0.5265  1.1570 0.4948</span></span>
<span><span class="co">#&gt; value(log(serBilir)):CRtransplanted  1.0586 0.2124  0.6694  1.5045 0.0000</span></span>
<span><span class="co">#&gt; value(log(serBilir)):CRdead          1.4241 0.1096  1.2156  1.6460 0.0000</span></span>
<span><span class="co">#&gt; value(prothrombin):CRtransplanted    0.0792 0.1158 -0.1625  0.2915 0.4618</span></span>
<span><span class="co">#&gt; value(prothrombin):CRdead            0.1339 0.0477  0.0311  0.2199 0.0162</span></span>
<span><span class="co">#&gt;                                       Rhat</span></span>
<span><span class="co">#&gt; age                                 1.0876</span></span>
<span><span class="co">#&gt; drugD-penicil                       1.0319</span></span>
<span><span class="co">#&gt; age:strata(CR)dead                  1.1269</span></span>
<span><span class="co">#&gt; drugD-penicil:strata(CR)dead        1.0333</span></span>
<span><span class="co">#&gt; value(log(serBilir)):CRtransplanted 1.0353</span></span>
<span><span class="co">#&gt; value(log(serBilir)):CRdead         1.0023</span></span>
<span><span class="co">#&gt; value(prothrombin):CRtransplanted   1.3023</span></span>
<span><span class="co">#&gt; value(prothrombin):CRdead           1.0112</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Longitudinal Outcome: log(serBilir) (family = gaussian, link = identity)</span></span>
<span><span class="co">#&gt;                   Mean  StDev    2.5%   97.5%      P   Rhat</span></span>
<span><span class="co">#&gt; (Intercept)     1.1541 0.0978  0.9626  1.3484 0.0000 0.9999</span></span>
<span><span class="co">#&gt; poly(year, 2)1 26.0863 1.9731 22.2498 30.0239 0.0000 1.0014</span></span>
<span><span class="co">#&gt; poly(year, 2)2  0.8121 1.3953 -1.9108  3.5203 0.5580 1.0000</span></span>
<span><span class="co">#&gt; drugD-penicil  -0.1552 0.1346 -0.4175  0.1103 0.2462 1.0005</span></span>
<span><span class="co">#&gt; p(,2)1         -1.9547 2.2371 -6.2728  2.4660 0.3787 1.0004</span></span>
<span><span class="co">#&gt; p(,2)2         -0.9302 1.7152 -4.2955  2.4247 0.5847 1.0011</span></span>
<span><span class="co">#&gt; sigma           0.3022 0.0061  0.2905  0.3144 0.0000 1.0008</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Longitudinal Outcome: prothrombin (family = gaussian, link = identity)</span></span>
<span><span class="co">#&gt;                       Mean  StDev    2.5%   97.5%      P   Rhat</span></span>
<span><span class="co">#&gt; (Intercept)        10.6228 0.0803 10.4671 10.7797 0.0000 1.0018</span></span>
<span><span class="co">#&gt; year                0.2904 0.0382  0.2157  0.3663 0.0000 1.0030</span></span>
<span><span class="co">#&gt; drugD-penicil      -0.0880 0.1121 -0.3080  0.1261 0.4367 1.0001</span></span>
<span><span class="co">#&gt; year:drugD-penicil -0.0192 0.0503 -0.1172  0.0803 0.7062 1.0004</span></span>
<span><span class="co">#&gt; sigma               1.0547 0.0204  1.0153  1.0958 0.0000 1.0011</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; MCMC summary:</span></span>
<span><span class="co">#&gt; chains: 3 </span></span>
<span><span class="co">#&gt; iterations per chain: 25000 </span></span>
<span><span class="co">#&gt; burn-in per chain: 5000 </span></span>
<span><span class="co">#&gt; thinning: 5 </span></span>
<span><span class="co">#&gt; time: 6.8 min</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="dynamic-predictions">Dynamic predictions<a class="anchor" aria-label="anchor" href="#dynamic-predictions"></a>
</h3>
<p>Based on the fitted competing risks joint model, we will illustrate
how (dynamic) predictions for the cause-specific cumulative risk
probabilities can be calculated. As an example, we will show these
calculations for Patient 81 from the PBC dataset. First, we extract the
data of this subject.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ND_long</span> <span class="op">&lt;-</span> <span class="va">pbc2</span><span class="op">[</span><span class="va">pbc2</span><span class="op">$</span><span class="va">id</span> <span class="op">==</span> <span class="fl">81</span>, <span class="op">]</span></span>
<span><span class="va">ND_event</span> <span class="op">&lt;-</span> <span class="va">pbc2.idCR</span><span class="op">[</span><span class="va">pbc2.idCR</span><span class="op">$</span><span class="va">id</span> <span class="op">==</span> <span class="fl">81</span>, <span class="op">]</span></span>
<span><span class="va">ND_event</span><span class="op">$</span><span class="va">status2</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ND</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>newdataL <span class="op">=</span> <span class="va">ND_long</span>, newdataE <span class="op">=</span> <span class="va">ND_event</span><span class="op">)</span></span></code></pre></div>
<p>The first line extracts the longitudinal measurements, and the second
line extracts the event times per cause (i.e., death and
transplantation). This particular patient died at 6.95 years, but to
make the calculation of cause-specific cumulative risk more relevant, we
presume that she did not have the event, and we set the event status
variable <code>status2</code> to zero. The last line combines the two
datasets in a list. <em>Note:</em> this last step is a prerequisite from
the <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> method for competing risks joint model. That
is, the datasets provided in the arguments <code>newdata</code> and
<code>newdata2</code> need to be named lists with two components. The
first component needs to be named <code>newdataL</code> and contain the
dataset with the longitudinal measurements, and the second component
needs to be named <code>newdataE</code> and contain the dataset with the
event information.</p>
<p>The predictions are calculated using the <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code>
method. The first call to this function calculates the prediction for
the longitudinal outcomes at the times provided in the
<code>times</code> argument, and the second call calculates the
cause-specific cumulative risk probabilities. By setting the argument
<code>return_newdata</code> to <code>TRUE</code> in both calls, we can
use the corresponding <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> method to depict the
predictions:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">predLong</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">jFit_CR</span>, newdata <span class="op">=</span> <span class="va">ND</span>, return_newdata <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                    times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">6.5</span>, <span class="fl">15</span>, length <span class="op">=</span> <span class="fl">25</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">predEvent</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">jFit_CR</span>, newdata <span class="op">=</span> <span class="va">ND</span>, return_newdata <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                     process <span class="op">=</span> <span class="st">"event"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">predLong</span>, <span class="va">predEvent</span>, outcomes <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, ylim_long_outcome_range <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>     col_line_event <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#03BF3D"</span>, <span class="st">"#FF0000"</span><span class="op">)</span>, </span>
<span>     fill_CI_event <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#03BF3D4D"</span>, <span class="st">"#FF00004D"</span><span class="op">)</span>, pos_ylab_long <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">11.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">8.1</span>, y <span class="op">=</span> <span class="fl">0.45</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">pbc2.idCR</span><span class="op">$</span><span class="va">CR</span><span class="op">)</span>, </span>
<span>       lty <span class="op">=</span> <span class="fl">1</span>, lwd <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#03BF3D"</span>, <span class="st">"#FF0000"</span><span class="op">)</span>, bty <span class="op">=</span> <span class="st">"n"</span>, cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span></code></pre></div>
<p><img src="Competing_Risks_files/figure-html/CIFs-1.png" width="700"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="http://www.drizopoulos.com/" class="external-link">Dimitris Rizopoulos</a>, <a href="https://gregpapageorgiou.com/" class="external-link">Grigorios Papageorgiou</a>, <a href="https://pafonso.com/" class="external-link">Pedro Miranda Afonso</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '66a8ef39105517ba1ce2f07aa1c70890',
    indexName: 'drizopoulos',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
